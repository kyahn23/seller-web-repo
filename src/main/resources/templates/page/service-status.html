<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorator="layout/default">
<th:block layout:fragment="css">
    <style>
        .searchArea .txtSize2 input, .searchArea .txtSize2 select {
            width: 100%;
        }

        /*.tBodyScroll {*/
        /*    height: 432px;*/
        /*}*/
        /*.underLine {*/
        /*    color: #007ac6;*/
        /*    text-decoration: underline;*/
        /*}*/
    </style>
</th:block>
<div layout:fragment="content">
    <!-- contents -->
    <div class="sectionRight" id="content">
        <div class="contentWrap">
            <div class="onlyWideView">

                <div class="subHeader">
                    <div id="foldUnfold"><a href="#" class="btnFold"><span>좌측메뉴 접기/펴기</span></a></div>
                    <h2 class="h2"><img src="../images/cmmn/hidden.png" class="ico-vendor" alt="아이콘">상담관리현황</h2>
                    <div class="pageLocation">
                        <span>상담 관리</span>&gt;<strong>상담관리현황</strong>
                    </div>
                </div>

                <div class="searchArea">
                    <ul>
                        <!--                        <li class="txtSize2">-->
                        <!--                            <label>등록일</label>-->
                        <!--                            <span>-->
                        <!--                                <vuejs-datepicker ref="programaticOpen1" :language="ko" placeholder="등록일"-->
                        <!--                                                  name="calendar01"-->
                        <!--                                                  :input-class="'dpInputWidth'" :wrapper-class="'dpWrapWidth'"-->
                        <!--                                                  :format="format" v-model="searchDay">-->
                        <!--                                </vuejs-datepicker>-->
                        <!--                            </span>-->
                        <!--                            <span>-->
                        <!--                                <button @click="openPicker1"-->
                        <!--                                        style="vertical-align: middle; width: 19px; height: 23px; background: url('../../images/cmmn/bg_ico_calender.gif') 0 0 no-repeat;">-->
                        <!--                                </button>-->
                        <!--                            </span>-->
                        <!--                        </li>-->
                        <li class="txtSize3">
                            <label for="marketing01">구분</label>
                            <select id="marketing01" v-model="selectedCallCd">
                                <option v-for="call in callStCd" :value="call.code">{{call.value}}</option>
                            </select>
                        </li>
                        <li class="txtSize5">
                            <label for="marketing02">고객명</label>
                            <input type="text" id="marketing02" placeholder="고객명 입력" v-model="clientNm">
                        </li>
                        <li class="txtSize5">
                            <label for="marketing03">등록자</label>
                            <select id="marketing03" v-model="selectedBnMbr">
                                <option value="all">전체</option>
                                <option v-for="mbr in bnMbr" :value="mbr.bnMbrId">{{mbr.mbrNm}}</option>
                            </select>
                        </li>
                    </ul>
                    <div class="btnSearch">
                        <a href="#" class="btnM colorBlue" @click="searchList"><span>검색</span></a>
                    </div>
                </div>

                <!-- content group1 -->
                <div class="contentBlock">
                    <div class="contentTitle">
                        <div class="cTit">
                            상담 처리 현황
                        </div>
                        <div class="cTitRight">
                            <div class="SelectBoxBasic selectPaging">
                                <input type="hidden" value="1page"/>
                                <div class="DefaultName">{{pageInfo.page}} page</div>
                                <ul>
                                    <li v-for="item in pageInfo.slider" :id='item+"page"' @click="goToPage(item)">
                                        {{item}} page
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <!-- content -->
                    <div class="contentDetail slideTogglebox">
                        <div class="tHeadScrollBG">
                            <div class="tHeadScroll">
                                <table class="tblList tHead">
                                    <colgroup>
                                        <col style="width:10%">
                                        <col style="width:10%">
                                        <col style="width:10%">
                                        <col style="width:10%">
                                        <col style="width:*">
                                        <col style="width:*">
                                        <col style="width:10%">
                                        <col style="width:*">
                                    </colgroup>
                                    <tbody>
                                    <tr>
                                        <td>구분</td>
                                        <td>고객명</td>
                                        <td>통신사</td>
                                        <td>가입유형</td>
                                        <td>상담요금제</td>
                                        <td>휴대폰</td>
                                        <td>등록자</td>
                                        <td>등록일시</td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="tBodyScroll">
                            <table class="tblList tBody trClick">
                                <caption>상담 처리 현황 정보</caption>
                                <colgroup>
                                    <col style="width:10%">
                                    <col style="width:10%">
                                    <col style="width:10%">
                                    <col style="width:10%">
                                    <col style="width:*">
                                    <col style="width:*">
                                    <col style="width:10%">
                                    <col style="width:*">
                                </colgroup>
                                <thead>
                                <tr>
                                    <td>구분</td>
                                    <td>고객명</td>
                                    <td>통신사</td>
                                    <td>개통유형</td>
                                    <td>상담요금제</td>
                                    <td>휴대폰</td>
                                    <td>등록자</td>
                                    <td>등록일시</td>
                                </tr>
                                </thead>
                                <tbody>
                                <tr v-for="(list,idx) in counselList" @click="selectCs(list,idx)"
                                    :class="{ checkedItem: getTrClass(idx) }">
                                    <td class="alignC">{{list.callStNm}}</td>
                                    <td class="alignC">{{list.clMbrNm}}</td>
                                    <td class="alignC">{{list.mntCarr}}</td>
                                    <td class="alignC">{{list.pnRegDisNm}}</td>
                                    <td class="alignC">{{list.pnMntRtNm}}</td>
                                    <td class="alignC">{{list.pnMdlNm}}</td>
                                    <td class="alignC">{{list.mbrNm}}</td>
                                    <td class="alignC">{{list.amdDt}}</td>
                                </tr>
                                <!-- 결과없음 -->
                                <tr v-if="counselList.length == 0" :class="{errorMessage : counselList.length == 0 }">
                                    <td colspan="8">
                                        <div class="errorTxt">
                                            <span>항목이 없습니다.</span>
                                        </div>
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <!-- //content -->
                </div>
                <!-- //content group1 -->

                <!-- content group2 -->
                <div class="contentBlock">
                    <div class="contentTitle">
                        <div class="cTit">
                            상담 처리 상세정보
                        </div>
                        <div class="cTitRight">
                            <!-- !!! 여기가 팝업 버튼 !!! -->
                            <div id="btn2">
                                <a href="#popLayerServiceResultAdd"
                                   class="btnM colorGreen popLayerServiceResultAdd_open"
                                   @click="modiBtnClick"
                                   v-if="selectedCs.callStCd === 'T' || selectedCs.callStCd === 'E'">
                                    <span>수정하기</span>
                                </a>
                            </div>
                        </div>
                    </div>
                    <!-- content -->
                    <div class="contentDetail">
                        <table class="tblDataRow mb15">
                            <colgroup>
                                <col style="width:140px">
                                <col style="width:*">
                                <col style="width:140px">
                                <col style="width:*">
                            </colgroup>
                            <tbody>
                            <tr>
                                <th>개통 구분</th>
                                <td v-if="selectedCs.callNo">{{selectedCs.callStNm}}</td>
                                <td v-else>-</td>
                                <th>개통담당자</th>
                                <td v-if="selectedCs.callNo">{{rsltToReg.mbrNm}}</td>
                                <td v-else>-</td>
                            </tr>
                            <tr>
                                <th>통신사</th>
                                <td v-if="selectedCs.callNo">{{selectedCs.mntCarr}}</td>
                                <td v-else>-</td>
                                <th>가입유형</th>
                                <td v-if="selectedCs.callNo">{{selectedCs.pnRegDisNm}}</td>
                                <td v-else>-</td>
                            </tr>
                            <tr>
                                <th>요금제</th>
                                <td v-if="selectedCs.callNo">{{selectedCs.pnMntRtNm}}</td>
                                <td v-else>-</td>
                                <th>약정기간</th>
                                <td v-if="selectedCs.callNo">
                                    <input type="radio" id="period12" value="12" v-model="selectedCs.regPd" disabled>
                                    <label for="period12">12개월</label>&nbsp;
                                    <input type="radio" id="period24" value="24" v-model="selectedCs.regPd" disabled>
                                    <label for="period24">24개월</label>
                                </td>
                                <td v-else>-</td>
                            </tr>
                            <tr>
                                <th>제조사</th>
                                <td v-if="selectedCs.callNo">{{selectedCs.pnMkrNm}}</td>
                                <td v-else>-</td>
                                <th>모델</th>
                                <td v-if="selectedCs.callNo">{{selectedCs.pnMdlNm}} {{selectedCs.pnStor}}GB</td>
                                <td v-else>-</td>
                            </tr>
                            <tr>
                                <th>부가서비스</th>
                                <td colspan="3" v-if="selectedCs.callNo">
                                    <input v-if="selectedCs.callStCd === 'T'" type="radio" id="extServY" value="Y" v-model="selectedCs.regExtServYn" disabled>
                                    <input v-else type="radio" id="extServY" value="Y" v-model="selectedCs.oldExtServYn" disabled>
                                    <label for="extServY">유</label>&nbsp;
                                    <input v-if="selectedCs.callStCd === 'T'" type="radio" id="extServN" value="N" v-model="selectedCs.regExtServYn" disabled>
                                    <input v-else type="radio" id="extServN" value="N" v-model="selectedCs.oldExtServYn" disabled>
                                    <label for="extServN">무</label>
                                </td>
                                <td colspan="3" v-else>-</td>
                            </tr>
                            <tr>
                                <th>상담내용</th>
                                <td colspan="3" v-if="selectedCs.callNo && selectedCs.callStCd !== 'R'">{{selectedCs.callCont}}</td>
                                <td colspan="3" v-else>-</td>
                            </tr>
                            <tr>
                                <th>기타사항</th>
                                <td colspan="3" v-if="selectedCs.callNo && selectedCs.callStCd === 'T'">{{selectedCs.dealCont}}</td>
                                <td colspan="3" v-else-if="selectedCs.callNo && selectedCs.callStCd === 'E'">{{selectedCs.cnclCmnt}}</td>
                                <td colspan="3" v-else>-</td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                    <!-- //content -->
                </div>
                <!-- //content group2 -->

            </div>
        </div>
    </div>
    <!-- //contents -->
</div>

<div layout:fragment="layer">
    <!-- 팝업: 개통결과등록 -->
    <div class="layerWrapper layerSizeM" id="popLayerServiceResultAdd" style="display:inherit !important">
        <div class="layerHeader">
            <strong v-if>개통결과 수정</strong>
            <a href="#" class="btnClose popLayerServiceResultAdd_close"><img src="../images/cmmn/btn-layer-close.png"
                                                                             alt="창닫기"></a>
        </div>
        <div class="layerContainer">
            <div class="layerContent">

                <!-- 컨텐츠 -->
                <div class="guidanceWrapper">
                    <table class="tblDataRow">
                        <caption>개통결과수정</caption>
                        <colgroup>
                            <col style="width:80px">
                            <col style="width:*">
                            <col style="width:80px">
                            <col style="width:*">
                        </colgroup>
                        <tbody>
                        <tr>
                            <th>구분</th>
                            <td :colspan="modiCallStCd==='T'? 3 : 1">
                                <input type="radio" id="saleSucc" name="saleRslt" value="T" v-model="modiCallStCd">
                                <label for="saleSucc">개통완료</label>&nbsp;
                                <input type="radio" id="saleFail" name="saleRslt" value="E" v-model="modiCallStCd">
                                <label for="saleFail">미개통</label>
                            </td>
                            <th v-if="modiCallStCd === 'E'">블랙여부</th>
                            <td v-if="modiCallStCd === 'E'">
                                <input type="checkbox" id="addBlacklist" v-model="blackYn">
                                <label for="addBlacklist">등록</label>
                            </td>
                        </tr>
                        <tr>
                            <th>개통담당자</th>
                            <td colspan="3">
                                <select class="wPer" v-model="rsltToReg.bnMbrId">
                                    <option v-for="mbr in bnMbr" :value="mbr.bnMbrId">{{mbr.mbrNm}}</option>
                                </select>
                            </td>
                        </tr>
                        <tr>
                            <th>고객명</th>
                            <td>{{rsltToReg.clMbrNm}}
                            </td>
                            <th>개통번호</th>
                            <td>
                                <input class="wPer" type="text"
                                       placeholder="개통번호" v-model="rsltToReg.mbrPnNo"
                                       :disabled='modiCallStCd==="E"'>
                            </td>
                        </tr>
                        <tr>
                            <th>통신사</th>
                            <td>
                                <select class="wPer" v-model="rsltToReg.mntCarr" :disabled='modiCallStCd==="E"'>
                                    <option v-for="carr in carrArr" :value="carr.code">{{carr.value}}</option>
                                </select>
                            </td>
                            <th>조건</th>
                            <td>
                                <select class="wPer" v-model="rsltToReg.pnRegDis" :disabled='modiCallStCd==="E"'>
                                    <option v-for="type in counselType" :value="type.code">{{type.value}}</option>
                                </select>
                            </td>
                        </tr>
                        <tr>
                            <th>요금제</th>
                            <td>
                                <select class="wPer" v-model="rsltToReg.pnMntRtNo" :disabled='modiCallStCd==="E"'>
                                    <option v-for="mntrt in useMntrtListByCarr" :value="mntrt.pnMntRtNo">
                                        {{mntrt.pnMntRtNm}}
                                    </option>
                                </select>
                            </td>
                            <th>약정기간</th>
                            <td>
                                <input type="radio" id="layerPeriod12" name="RegPeriod" value="12" v-model="rsltToReg.regPd" :disabled='modiCallStCd==="E"'>
                                <label for="layerPeriod12">12개월</label>&nbsp;
                                <input type="radio" id="layerPeriod24" name="RegPeriod" value="24" v-model="rsltToReg.regPd" :disabled='modiCallStCd==="E"'>
                                <label for="layerPeriod24">24개월</label>
                            </td>
                        </tr>
                        <tr>
                            <th>제조사</th>
                            <td>
                                <select class="wPer" v-model="selectedMkr" :disabled='modiCallStCd==="E"'>
                                    <option v-for="mkr in pnMkr" :value="mkr.code">{{mkr.value}}</option>
                                </select>
                            </td>
                            <th>모델</th>
                            <td>
                                <select class="wPer" v-model="rsltToReg.pnMdlNo" :disabled='modiCallStCd==="E"'>
                                    <option v-for="device in devListByMkr" :value="device.pnMdlNo">{{device.pnMdlNm}}
                                    </option>
                                </select>
                            </td>
                        </tr>
                        <tr>
                            <th>부가서비스</th>
                            <td colspan="3">
                                <input type="radio" id="layerExtServY" value="Y" :disabled='modiCallStCd==="E"'
                                       v-model="rsltToReg.regExtServYn"><label for="layerExtServY">유</label>&nbsp;
                                <input type="radio" id="layerExtServN" value="N" :disabled='modiCallStCd==="E"'
                                       v-model="rsltToReg.regExtServYn"><label for="layerExtServN">무</label>
                            </td>
                        </tr>
                        <tr>
                            <th>상담내용</th>
                            <td colspan="3">
                                <input class="wPer" type="text" placeholder="상담결과내용" v-model="rsltToReg.callCont" :disabled='modiCallStCd==="E"'>
                            </td>
                        </tr>
                        <tr>
                            <th>기타사항</th>
                            <td colspan="3" style="height: 85px">
                                <textarea style="width: 100%; height: 100%;" v-model="rsltTxt" placeholder="특이사항또는 블랙사유를 입력해주세요."></textarea>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
                <!-- //컨텐츠 -->
                <div class="btnWrapper">
                    <a href="#" class="btnL colorBlue" @click="registerRslt"><span>저장</span></a>
                </div>
            </div>
        </div>
    </div>
</div>

<div layout:fragment="script">
<!--     //팝업: 개통결과 또는 블랙고객등록-->
        <script type="text/javascript">
            $(function () {
                if ($(".layerWrapper").length) {
                    //개통결과등록
                    $('#popLayerServiceResultAdd').popup();
                }
            });
        </script>
    <script>
        var app = new Vue({
            el: "#app",
            data: {
                callStCd: [
                    {code: "all", value: "전체"},
                    {code: "R", value: "상담접수"},
                    {code: "P", value: "방문예정"},
                    {code: "T", value: "개통완료"},
                    {code: "E", value: "미개통"}
                ],
                carrArr: [
                    {code: "all", value: "선택"},
                    {code: "SKT", value: "SKT"},
                    {code: "KT", value: "KT"},
                    {code: "LGU", value: "LGU"}
                ],
                counselType: [
                    {code: "all", value: "선택"},
                    {code: "A", value: "번호이동"},
                    {code: "B", value: "기기변경"},
                    {code: "C", value: "신규가입"},
                ],
                period: [
                    {code: "12", value: "12개월"},
                    {code: "24", value: "24개월"}
                ],
                pnMkr: [
                    {code: "all", value: "선택"},
                    {code: "SAM", value: "삼성전자"},
                    {code: "APP", value: "애플"},
                    {code: "LGE", value: "LG전자"},
                    {code: "XIA", value: "샤오미"},
                    {code: "ETC", value: "기타"}
                ],
                selectedCallCd: "all",
                clientNm: "",
                today: "",
                bnMbr: [],
                selectedBnMbr: "all",
                counselList: [],            // 현재 페이지 상담 리스트
                blackYn: false,
                selectedCs: {},
                rsltToReg: {},
                modiCallStCd: "",
                selectedMkr: "",
                rsltTxt:"",
                mntrtList: [],              // 사용중인 전체 요금제 리스트
                useMntrtListByCarr: [],     //  통신사에 따른 사용 요금제 리스트
                deviceList: [],             // 전체 디바이스 목록
                devListByMkr: [],           // 선택된 제조사에 따른 디바이스 목록
                pageNo: "1",
                pageInfo: [],              // 현재 페이지 정보
            },
            mounted: function () {
                this.getBnMbrList()
            },
            watch: {
                'rsltToReg.mntCarr': {
                    handler(value) {
                        this.rsltLayerDeviceInit()

                        let tempArr = []
                        this.useMntrtListByCarr = []
                        switch (value) {
                            case 'SKT':
                                for (list in this.mntrtList) {
                                    if (this.mntrtList[list].pnCarr === 'SKT') {
                                        tempArr.push(this.mntrtList[list])
                                    }
                                }
                                break
                            case 'KT':
                                for (list in this.mntrtList) {
                                    if (this.mntrtList[list].pnCarr === 'KT') {
                                        tempArr.push(this.mntrtList[list])
                                    }
                                }
                                break
                            case 'LGU':
                                for (list in this.mntrtList) {
                                    if (this.mntrtList[list].pnCarr === 'LGU') {
                                        tempArr.push(this.mntrtList[list])
                                    }
                                }
                                break
                        }
                        if (value !== this.selectedCs.mntCarr) {
                            this.rsltToReg.pnRegDis = "all"
                            this.rsltToReg.pnMntRtNo = "all"
                        }
                        this.useMntrtListByCarr = tempArr
                    },
                    immediate: true
                },
                selectedMkr: function (data) {
                    let mntCarr = this.rsltToReg.mntCarr
                    switch (this.rsltToReg.mntCarr) {
                        case 'SKT':
                            mntCarr = 'S'
                            break
                        case 'KT':
                            mntCarr = 'K'
                            break
                        case 'SKT':
                            mntCarr = 'L'
                            break
                    }
                    let tempArr = []
                    switch (data) {
                        case 'SAM':
                            for (list in this.deviceList) {
                                if (this.deviceList[list].pnMkr === 'SAM' && this.deviceList[list].pnCarr.includes(mntCarr)) {
                                    tempArr.push(this.deviceList[list])
                                }
                            }
                            break
                        case 'LGE':
                            for (list in this.deviceList) {
                                if (this.deviceList[list].pnMkr === 'LGE' && this.deviceList[list].pnCarr.includes(mntCarr)) {
                                    tempArr.push(this.deviceList[list])
                                }
                            }
                            break
                        case 'APP':
                            for (list in this.deviceList) {
                                if (this.deviceList[list].pnMkr === 'APP' && this.deviceList[list].pnCarr.includes(mntCarr)) {
                                    tempArr.push(this.deviceList[list])
                                }
                            }
                            break
                        case 'XIA':
                            for (list in this.deviceList) {
                                if (this.deviceList[list].pnMkr === 'XIA' && this.deviceList[list].pnCarr.includes(mntCarr)) {
                                    tempArr.push(this.deviceList[list])
                                }
                            }
                            break
                    }
                    this.devListByMkr = tempArr
                },
                modiCallStCd: function(data){
                    this.rsltTxt = ""
                    if (data === 'T'){
                        this.blackYn = false
                    }
                    // if (this.selectedCs.callStCd !== data){
                    //
                    // }
                }
            },
            methods: {
                getBnMbrList() {
                    var param = {}
                    cf_call("/service/bnMbrList", param, this.getBnMbrListCB)
                },
                getBnMbrListCB(data) {
                    this.bnMbr = data

                    let type = 'init'
                    this.searchList(type)
                },
                searchList(data) {
                    let param = {
                        callStCd: this.selectedCallCd,
                        mntCarr: "all",
                        counselType: "all",
                        // searchDay: yy,
                        clientNm: this.clientNm,
                        bnMbr: this.selectedBnMbr,
                        page: "1"
                    }
                    if (data === 'page') {
                        param.page = this.pageNo
                    }
                    if (data === 'init') {
                        this.selectedCallCd = "all"
                        this.clientNm = ""
                        this.selectedBnMbr = "all"
                    }
                    this.counselList = []
                    this.selectedCs = {}
                    this.rsltToReg = {}
                    this.modiCallStCd = ''
                    cf_call("/service/getAllCounselList", param, this.searchListCB)
                },
                searchListCB(data) {
                    this.pageInfo = data.pageInfo
                    let tempArr = []

                    for (idx in data.counselList) {
                        data.counselList[idx].idx = idx
                        switch (data.counselList[idx].pnRegDis) {
                            case "A":
                                data.counselList[idx].pnRegDisNm = '번호이동'
                                break
                            case "B":
                                data.counselList[idx].pnRegDisNm = '기기변경'
                                break
                            case "C":
                                data.counselList[idx].pnRegDisNm = '신규가입'
                                break
                        }
                        switch (data.counselList[idx].callStCd) {
                            case "R":
                                data.counselList[idx].callStNm = '상담접수'
                                break
                            case "P":
                                data.counselList[idx].callStNm = '방문예정'
                                break
                            case "T":
                                data.counselList[idx].callStNm = '개통완료'
                                break
                            case "E":
                                data.counselList[idx].callStNm = '미개통'
                                break
                        }
                    }
                    this.counselList = data.counselList
                },
                goToPage(data) {
                    this.pageNo = "" + data
                    let type = 'page'
                    this.searchList(type)
                },
                selectCs(data, idx) {
                    if (this.selectedCs.idx != idx) {
                        this.selectedCs = {}
                        this.selectedCs = data
                        this.selectedCs.idx = idx
                        this.rsltToReg = JSON.parse(JSON.stringify(data))
                        this.modiCallStCd = this.rsltToReg.callStCd

                        switch (this.selectedCs.pnMkr) {
                            case "SAM":
                                this.selectedCs.pnMkrNm = '삼성전자'
                                break
                            case "LGE":
                                this.selectedCs.pnMkrNm = 'LG전자'
                                break
                            case "APP":
                                this.selectedCs.pnMkrNm = '애플'
                                break
                            case "XIA":
                                this.selectedCs.pnMkrNm = '샤오미'
                                break
                            case "ETC":
                                this.selectedCs.pnMkrNm = '기타'
                                break
                        }


                        this.rsltLayerMntRtInit()
                    } else {
                        this.selectedCs = {}
                        this.rsltToReg = {}
                        this.modiCallStCd = ''
                    }
                },
                getTrClass(idx) {
                    if (idx === this.selectedCs.idx) return true
                    else return false
                },
                modiBtnClick(){
                    this.rsltToReg = JSON.parse(JSON.stringify(this.selectedCs))
                    this.modiCallStCd = this.rsltToReg.callStCd

                    if (this.rsltToReg.callStCd === 'T'){
                        this.rsltTxt = this.rsltToReg.dealCont
                    } else {
                        this.rsltTxt = this.rsltToReg.cnclCmnt
                    }

                },
                rsltLayerMntRtInit() {

                    if (!this.selectedCs.idx) {
                        this.selectedMkr = this.selectedCs.pnMkr
                    } else {
                        this.selectedMkr = this.rsltToReg.pnMkr
                    }

                    let param = {}
                    cf_call("/service/useAllCarrMntRt", param, this.rsltLayerMntRtInitCB)
                },
                rsltLayerMntRtInitCB(data) {
                    this.mntrtList = data.mntrtList
                    let temp = ''
                    this.useMntRtList(this.rsltToReg.mntCarr, this.rsltToReg.pnNetType)
                    this.rsltLayerDeviceInit()
                },
                rsltLayerDeviceInit() {
                    let carr = ''
                    switch (this.rsltToReg.mntCarr) {
                        case "SKT":
                            carr = 'S'
                            break
                        case "KT":
                            carr = 'K'
                            break
                        case "LGU":
                            carr = 'L'
                            break
                    }
                    let param = {
                        mntCarr: carr
                    }
                    cf_call("/service/allDeviceListByCarr", param, this.rsltLayerDeviceInitCB)
                },
                rsltLayerDeviceInitCB(data) {
                    this.deviceList = data.deviceList
                    let netType = this.rsltToReg.pnNetType
                    let tempArr = []
                    switch (this.selectedMkr) {
                        case 'SAM':
                            for (list in this.deviceList) {
                                if (this.deviceList[list].pnMkr === 'SAM' && this.deviceList[list].pnNetType === netType) {
                                    tempArr.push(this.deviceList[list])
                                }
                            }
                            break
                        case 'LGE':
                            for (list in this.deviceList) {
                                if (this.deviceList[list].pnMkr === 'LGE' && this.deviceList[list].pnNetType === netType) {
                                    tempArr.push(this.deviceList[list])
                                }
                            }
                            break
                        case 'APP':
                            for (list in this.deviceList) {
                                if (this.deviceList[list].pnMkr === 'APP' && this.deviceList[list].pnNetType === netType) {
                                    tempArr.push(this.deviceList[list])
                                }
                            }
                            break
                        case 'XIA':
                            for (list in this.deviceList) {
                                if (this.deviceList[list].pnMkr === 'XIA' && this.deviceList[list].pnNetType === netType) {
                                    tempArr.push(this.deviceList[list])
                                }
                            }
                            break
                    }
                    this.devListByMkr = tempArr

                },
                useMntRtList(data1, data2) {
                    let tempArr = []
                    this.useMntrtListByCarr = []
                    switch (data1) {
                        case 'SKT':
                            for (list in this.mntrtList) {
                                if (this.mntrtList[list].pnCarr === 'SKT' && this.mntrtList[list].pnNetType === data2) {
                                    tempArr.push(this.mntrtList[list])
                                }
                            }
                            break
                        case 'KT':
                            for (list in this.mntrtList) {
                                if (this.mntrtList[list].pnCarr === 'KT' && this.mntrtList[list].pnNetType === data2) {
                                    tempArr.push(this.mntrtList[list])
                                }
                            }
                            break
                        case 'LGU':
                            for (list in this.mntrtList) {
                                if (this.mntrtList[list].pnCarr === 'LGU' && this.mntrtList[list].pnNetType === data2) {
                                    tempArr.push(this.mntrtList[list])
                                }
                            }
                            break
                    }
                    this.useMntrtListByCarr = tempArr
                },
                registerRslt() {
                    let param = {}
                    if (this.modiCallStCd === 'T') {
                        param = {
                            callStCd: this.modiCallStCd,
                            bnMbrId: this.rsltToReg.bnMbrId,
                            regMbrPnNo: this.rsltToReg.mbrPnNo,
                            regCarr: this.rsltToReg.mntCarr,
                            regType: this.rsltToReg.pnRegDis,
                            regMntRtNo: this.rsltToReg.pnMntRtNo,
                            regPnMdlNo: this.rsltToReg.pnMdlNo,
                            regPd: this.rsltToReg.regPd,
                            dealCont: this.rsltToReg.dealCont,
                            pnRegYn: 'Y',
                            callNo: this.rsltToReg.callNo
                        }
                    } else if (this.modiCallStCd === 'E') {
                        param = {
                            bnMbrId: this.rsltToReg.bnMbrId,
                            callStCd: this.modiCallStCd,
                            pnRegYn: 'N',
                            cnclCmnt: this.rsltTxt,
                            callNo: this.rsltToReg.callNo
                        }
                    }

                    // 확인필요
                    if (this.rsltTxt.length === 0) {
                        alert('특이사항또는 블랙사유를 입력해주세요.')
                        return
                    }
                    if (confirm('개통결과를 수정하시겠습니까?')) {
                        console.log(param)
                        // cf_call("/service/registerRslt", param, this.registerRsltCB)
                    }

                },
                registerRsltCB(data) {
                    if (data.succ === "Y") {
                        alert('결과가 수정되었습니다.')
                        // this.visitHH = "all"
                        // this.visitMM = "all"
                        $('#popLayerServiceResultAdd').popup("hide");
                        this.getBnMbrList()
                    }
                }
            }
        })
    </script>
</div>
</html>