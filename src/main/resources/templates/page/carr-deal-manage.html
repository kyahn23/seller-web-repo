<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorator="layout/default">

<!-- 판매정책별 판매상태 토글버튼 css -->
<th:block layout:fragment="css">
    <style>
        .tblList tr th:first-child, .tblList tr td:first-child {
            border-left: 1px solid #e1e3e8;
        }

        .toggle__button {
            vertical-align: middle;
            user-select: none;
            cursor: pointer;
        }

        .toggle__button input[type="checkbox"] {
            opacity: 0;
            position: absolute;
            width: 1px;
            height: 1px;
        }

        .toggle__button .toggle__switch {
            display: inline-block;
            height: 12px;
            border-radius: 6px;
            width: 30px;
            background: #BFCBD9;
            box-shadow: inset 0 0 1px #BFCBD9;
            position: relative;
            /*margin-left: 10px;*/
            transition: all .25s;
        }

        .toggle__button .toggle__switch::after,
        .toggle__button .toggle__switch::before {
            content: "";
            position: absolute;
            display: block;
            height: 18px;
            width: 18px;
            border-radius: 50%;
            left: 0;
            top: -3px;
            transform: translateX(0);
            transition: all .25s cubic-bezier(.5, -.6, .5, 1.6);
        }

        .toggle__button .toggle__switch::after {
            background: #4D4D4D;
            box-shadow: 0 0 1px #666;
        }

        .toggle__button .toggle__switch::before {
            background: #4D4D4D;
            box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.1);
            opacity: 0;
        }

        .active .toggle__switch {
            background: #adedcb;
            box-shadow: inset 0 0 1px #adedcb;
        }

        .active .toggle__switch::after,
        .active .toggle__switch::before {
            transform: translateX(30px -18px);
        }

        .active .toggle__switch::after {
            left: 13px;
            background: #53B883;
            box-shadow: 0 0 1px #53B883;
        }
    </style>
</th:block>

<div layout:fragment="content">
    <!-- contents -->
    <div class="sectionRight" id="content">
        <div class="contentWrap">
            <div class="onlyWideView">

                <div class="subHeader">
                    <div id="foldUnfold"><a href="#" class="btnFold"><span>좌측메뉴 접기/펴기</span></a></div>
                    <h2 class="h2"><img th:src="@{/images/cmmn/hidden.png}" class="ico-list" alt="아이콘">판매정책관리
                    </h2>
                    <div class="pageLocation">
                        <span>{{carr.toUpperCase()}} 관리</span>&gt;<strong>판매정책관리</strong>
                    </div>
                </div>

                <div class="searchArea">
                    <ul>
                        <li class="txtSize4">
                            <label for="purchaes01">판매상태</label>
                            <select id="purchaes01" v-model="selectedSellOpt">
                                <option v-for="sell in sellYn" :value="sell.code">{{sell.value}}</option>
                            </select>
                        </li>
                        <li class="txtSize4">
                            <label for="purchaes02">제조사</label>
                            <select id="purchaes02" v-model="selectedMkr">
                                <option v-for="mkr in pnMkr" :value="mkr.code">{{mkr.value}}</option>
                            </select>
                        </li>
                        <li class="txtSize3">
                            <label for="purchaes03">모델명</label>
                            <input type="text" id="purchaes04" placeholder="모델명 입력" v-model="searchKey">
                        </li>
                        <li class="txtSize4">
                            <label for="purchaes03">통신유형</label>
                            <select id="purchaes03" v-model="selectedNetType">
                                <option v-for="net in networkType" :value="net.code">{{net.value}}</option>
                            </select>
                        </li>
                    </ul>
                    <div class="btnSearch">
                        <a href="#none" class="btnM colorBlue" @click="searchList"><span>검색</span></a>
                    </div>
                </div>

                <!-- content group1 -->
                <div class="contentBlock contentSlide">
                    <div class="contentTitle slideToggle">
                        <div class="cTit">
                            제품 현황
                            <span class="icon"></span>
                        </div>
                        <div class="cTitRight">
                            <a href="#none" class="btnM colorOrg" @click="stopSale"><span>판매중지</span></a>
                        </div>
                    </div>
                    <!-- slide content -->
                    <div class="contentDetail slideTogglebox">
                        <div class="tHeadScrollBG">
                            <div class="tHeadScroll">
                                <table class="tblList tHead">
                                    <colgroup>
                                        <col style="width:3%">
                                        <col style="width:7%">
                                        <col style="width:10%">
                                        <col style="width:12%">
                                        <col style="width:10%">
                                        <col style="width:10%">
                                        <col style="width:10%">
                                        <col style="width:10%">
                                        <col style="width:10%">
                                        <col style="width:*">
                                    </colgroup>
                                    <thead>
                                    <tr>
                                        <th scope="col"><input type="checkbox" title="행 선택" @change="checkAll"
                                                               v-model="allchecked"></th>
                                        <th scope="col">판매상태</th>
                                        <th scope="col">제조사</th>
                                        <th scope="col">모델명</th>
                                        <th scope="col">출고가</th>
                                        <th scope="col">통신유형</th>
                                        <th scope="col">용량</th>
                                        <th scope="col">모델코드</th>
                                        <th scope="col">등록자</th>
                                        <th scope="col">최종변경일시</th>
                                    </tr>
                                    </thead>
                                </table>
                            </div>
                        </div>
                        <div class="tBodyScroll">
                            <table class="tblList tBody trClick">
                                <colgroup>
                                    <col style="width:3%">
                                    <col style="width:7%">
                                    <col style="width:10%">
                                    <col style="width:12%">
                                    <col style="width:10%">
                                    <col style="width:10%">
                                    <col style="width:10%">
                                    <col style="width:10%">
                                    <col style="width:10%">
                                    <col style="width:*">
                                </colgroup>
                                <thead>
                                <tr>
                                    <th scope="col"><input type="checkbox" title="행 선택"></th>
                                    <th scope="col">판매상태</th>
                                    <th scope="col">제조사</th>
                                    <th scope="col">모델명</th>
                                    <th scope="col">출고가</th>
                                    <th scope="col">통신유형</th>
                                    <th scope="col">용량</th>
                                    <th scope="col">모델코드</th>
                                    <th scope="col">등록자</th>
                                    <th scope="col">최종변경일시</th>
                                </tr>
                                </thead>
                                <tbody v-if="dpList.length !== 0">
                                <tr v-for="(sell,idx) in dpList"
                                    :class="{ checkedItem: getTrClass(idx) }">
                                    <td class="alignC"><input type="checkbox" title="행 선택" v-model="checkedList"
                                                              :value="sell" @change="chkboxClick"></td>
                                    <td class="alignC" v-if="sell.sellStatus === 'Y'" @click="rowClick(sell,idx)">판매중
                                    </td>
                                    <td class="alignC" v-else-if="sell.sellStatus === 'P'" @click="rowClick(sell,idx)">
                                        판매중지
                                    </td>
                                    <td class="alignC" v-else @click="rowClick(sell,idx)">미판매</td>
                                    <td class="alignC" @click="rowClick(sell,idx)">{{sell.pnMkr}}</td>
                                    <td class="alignC" @click="rowClick(sell,idx)">{{sell.pnMdlNm}}</td>
                                    <td class="alignC" @click="rowClick(sell,idx)">
                                        {{Number(sell.pnMsrp).toLocaleString()}}
                                    </td>
                                    <td class="alignC" v-if="sell.pnNetType === '4G'" @click="rowClick(sell,idx)">LTE
                                    </td>
                                    <td class="alignC" v-else @click="rowClick(sell,idx)">{{sell.pnNetType}}</td>
                                    <td class="alignC" @click="rowClick(sell,idx)">{{sell.pnStor}}GB</td>
                                    <td class="alignC" @click="rowClick(sell,idx)">{{sell.pnMdlNo}}</td>
                                    <td class="alignC" v-if="!sell.lastModiMbr" @click="rowClick(sell,idx)">-</td>
                                    <td class="alignC" v-else @click="rowClick(sell,idx)">{{sell.lastModiMbr}}</td>
                                    <td class="alignC" v-if="!sell.lastModiDate" @click="rowClick(sell,idx)">-</td>
                                    <td class="alignC" v-else @click="rowClick(sell,idx)">{{sell.lastModiDate}}</td>
                                </tr>
                                </tbody>
                                <tbody v-else>
                                <tr class="errorMessage">
                                    <td colspan="10">
                                        <div class="errorTxt">
                                            <span>항목이 없습니다.</span>
                                        </div>
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <!-- //slide content -->
                </div>
                <!-- //content group1 -->

                <!-- content group2 -->
                <div class="contentBlock">
                    <div class="contentTitle">
                        <div class="cTit">
                            번호이동정책
                        </div>
                        <div class="cTitRight">
                            <a href="#" class="btnM colorSky" @click="savePolicy('moveCarr')"><span>번이정책 저장</span></a>
                        </div>
                    </div>
                    <!-- content -->
                    <div class="contentDetail">
                        <table class="tblList alignC">
                            <colgroup>
                                <col style="width:15%">
                                <col style="width:7%">
                                <col style="width:9%">
                                <col style="width:11%">
                                <col style="width:11%">
                                <col style="width:7%">
                                <col style="width:11%">
                                <col style="width:7%">
                                <col style="width:8%">
                                <col style="width:*">
                            </colgroup>
                            <thead>
                            <tr>
                                <th scope="col" rowspan="2">요금제</th>
                                <th scope="col" rowspan="2">월<br>기본요금</th>
                                <th scope="col" rowspan="2">판매상태</th>
                                <th colspan="3">공시지원금</th>
                                <th colspan="2">선택약정</th>
                                <th rowspan="2">부가서비스<br>유무</th>
                                <th rowspan="2">부가서비스 정책</th>
                            </tr>
                            <tr>

                                <th scope="col">공시지원금</th>
                                <th scope="col">추가지원금</th>
                                <th scope="col">할부원금</th>
                                <th scope="col">추가지원금</th>
                                <th scope="col">할부원금</th>
                            </tr>
                            </thead>
                            <tbody v-if="moveCarrList.length !== 0">
                            <tr v-for="(list, idx) in moveCarrList">
                                <td class="alignC">{{list.pnMntRtNm}}</td>
                                <td>{{Number(list.pnMntAmt).toLocaleString()}}</td>
                                <td>
                                    <label :for="'moveCarrYnBtn'+idx" :class="{'active': list.sellToggle}"
                                           class="toggle__button">
                                        <span v-if="list.sellYn === 'Y'" class="toggle__label">판매중</span>
                                        <span v-else class="toggle__label">미판매</span>

                                        <input type="checkbox" :id="'moveCarrYnBtn'+idx" v-model="list.sellToggle"
                                               @change="sellToggleBtn(list)">
                                        <span class="toggle__switch"></span>
                                    </label>
                                </td>
                                <td><input style="width: 100%" class="inMoney" type="text" v-model="list.pnOfclSubsd"
                                           placeholder="공시지원금" :disabled="!list.sellToggle">
                                </td>
                                <td>
                                    <input style="width: 100%" class="inMoney" type="text" v-model="list.pnExtSubsdDv"
                                           placeholder="공시 추가지원금" :disabled="!list.sellToggle">
                                </td>
                                <td>
                                    {{Number(selectDevice.pnMsrp - list.pnOfclSubsd -
                                    list.pnExtSubsdDv).toLocaleString()}}
                                </td>
                                <td>
                                    <input style="width: 100%" class="wPer inNumber" type="text"
                                           placeholder="선약 추가지원금" v-model="list.pnExtSubsdRt"
                                           :disabled="!list.sellToggle">
                                </td>
                                <td>
                                    {{Number(selectDevice.pnMsrp - list.pnExtSubsdRt).toLocaleString()}}
                                </td>
                                <td>
                                    <input type="radio" :id="'mvCarrY'+idx" value="Y" v-model="list.pnExtServYn"
                                           :disabled="!list.sellToggle">
                                    <label :for="'mvCarrY'+idx">유</label>
                                    <input type="radio" :id="'mvCarrN'+idx" value="N" v-model="list.pnExtServYn"
                                           :disabled="!list.sellToggle">
                                    <label :for="'mvCarrN'+idx">무</label>
                                </td>
                                <td>
                                    <input style="width: 100%;" type="text" v-model="list.pnEtc"
                                           :disabled="list.pnExtServYn === 'N' || !list.sellToggle">
                                </td>
                            </tr>
                            </tbody>
                            <tbody v-else>
                            <tr>
                                <td>-</td>
                                <td>-</td>
                                <td>-</td>
                                <td>-</td>
                                <td>-</td>
                                <td>-</td>
                                <td>-</td>
                                <td>-</td>
                                <td>-</td>
                                <td>-</td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                    <!-- //content -->
                </div>
                <!-- //content group2 -->

                <!-- content group3 -->
                <div class="contentBlock">
                    <div class="contentTitle">
                        <div class="cTit">
                            기기변경정책
                        </div>
                        <div class="cTitRight">
                            <a href="#" class="btnM colorSky" @click="savePolicy('chgDevice')"><span>기변정책 저장</span></a>
                        </div>
                    </div>
                    <!-- content -->
                    <div class="contentDetail">
                        <table class="tblList alignC">
                            <colgroup>
                                <col style="width:15%">
                                <col style="width:7%">
                                <col style="width:9%">
                                <col style="width:11%">
                                <col style="width:11%">
                                <col style="width:7%">
                                <col style="width:11%">
                                <col style="width:7%">
                                <col style="width:8%">
                                <col style="width:*">
                            </colgroup>
                            <thead>
                            <tr>
                                <th scope="col" rowspan="2">요금제</th>
                                <th scope="col" rowspan="2">월<br>기본요금</th>
                                <th scope="col" rowspan="2">판매상태</th>
                                <th colspan="3">공시지원금</th>
                                <th colspan="2">선택약정</th>
                                <th rowspan="2">부가서비스<br>유무</th>
                                <th rowspan="2">부가서비스 정책</th>
                            </tr>
                            <tr>

                                <th scope="col">공시지원금</th>
                                <th scope="col">추가지원금</th>
                                <th scope="col">할부원금</th>
                                <th scope="col">추가지원금</th>
                                <th scope="col">할부원금</th>
                            </tr>
                            </thead>
                            <tbody v-if="chgDeviceList.length !== 0">
                            <tr v-for="(list, idx) in chgDeviceList">
                                <td class="alignC">{{list.pnMntRtNm}}</td>
                                <td>{{Number(list.pnMntAmt).toLocaleString()}}</td>
                                <td>
                                    <label :for="'chgDeviceYnBtn'+idx" :class="{'active': list.sellToggle}"
                                           class="toggle__button">
                                        <span v-if="list.sellYn === 'Y'" class="toggle__label">판매중</span>
                                        <span v-else class="toggle__label">미판매</span>

                                        <input type="checkbox" :id="'chgDeviceYnBtn'+idx" v-model="list.sellToggle"
                                               @change="sellToggleBtn(list)">
                                        <span class="toggle__switch"></span>
                                    </label>
                                </td>
                                <td><input style="width: 100%" class="inMoney" type="text" v-model="list.pnOfclSubsd"
                                           placeholder="공시지원금" :disabled="!list.sellToggle">
                                </td>
                                <td>
                                    <input style="width: 100%" class="inMoney" type="text" v-model="list.pnExtSubsdDv"
                                           placeholder="공시 추가지원금" :disabled="!list.sellToggle">
                                </td>
                                <td>
                                    {{Number(selectDevice.pnMsrp - list.pnOfclSubsd -
                                    list.pnExtSubsdDv).toLocaleString()}}
                                </td>
                                <td>
                                    <input style="width: 100%" class="wPer inNumber" type="text"
                                           placeholder="선약 추가지원금" v-model="list.pnExtSubsdRt"
                                           :disabled="!list.sellToggle">
                                </td>
                                <td>
                                    {{Number(selectDevice.pnMsrp - list.pnExtSubsdRt).toLocaleString()}}
                                </td>
                                <td>
                                    <input type="radio" :id="'idxY'+idx" value="Y" v-model="list.pnExtServYn"
                                           :disabled="!list.sellToggle">
                                    <label :for="'idxY'+idx">유</label>
                                    <input type="radio" :id="'idxN'+idx" value="N" v-model="list.pnExtServYn"
                                           @change="list.pnEtc = ''" :disabled="!list.sellToggle">
                                    <label :for="'idxN'+idx">무</label>
                                </td>
                                <td>
                                    <input style="width: 100%;" type="text" v-model="list.pnEtc"
                                           :disabled="list.pnExtServYn === 'N' || !list.sellToggle">
                                </td>
                            </tr>
                            </tbody>
                            <tbody v-else>
                            <tr>
                                <td>-</td>
                                <td>-</td>
                                <td>-</td>
                                <td>-</td>
                                <td>-</td>
                                <td>-</td>
                                <td>-</td>
                                <td>-</td>
                                <td>-</td>
                                <td>-</td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                    <!-- //content -->
                </div>
                <!-- //content group3 -->

                <!-- content group4 -->
                <div class="contentBlock">
                    <div class="contentTitle">
                        <div class="cTit">
                            신규가입정책
                        </div>
                        <div class="cTitRight">
                            <a href="#none" class="btnM colorSky" @click="savePolicy('newSignUp')"><span>신규정책 저장</span></a>
                        </div>
                    </div>
                    <!-- content -->
                    <div class="contentDetail">
                        <table class="tblList alignC">
                            <colgroup>
                                <col style="width:15%">
                                <col style="width:7%">
                                <col style="width:9%">
                                <col style="width:11%">
                                <col style="width:11%">
                                <col style="width:7%">
                                <col style="width:11%">
                                <col style="width:7%">
                                <col style="width:8%">
                                <col style="width:*">
                            </colgroup>
                            <thead>
                            <tr>
                                <th scope="col" rowspan="2">요금제</th>
                                <th scope="col" rowspan="2">월<br>기본요금</th>
                                <th scope="col" rowspan="2">판매상태</th>
                                <th colspan="3">공시지원금</th>
                                <th colspan="2">선택약정</th>
                                <th rowspan="2">부가서비스<br>유무</th>
                                <th rowspan="2">부가서비스 정책</th>
                            </tr>
                            <tr>

                                <th scope="col">공시지원금</th>
                                <th scope="col">추가지원금</th>
                                <th scope="col">할부원금</th>
                                <th scope="col">추가지원금</th>
                                <th scope="col">할부원금</th>
                            </tr>
                            </thead>
                            <tbody v-if="newSignUpList.length !== 0">
                            <tr v-for="(list, idx) in newSignUpList">
                                <td class="alignC">{{list.pnMntRtNm}}</td>
                                <td>{{Number(list.pnMntAmt).toLocaleString()}}</td>
                                <td>
                                    <label :for="'newSignUpYnBtn'+idx" :class="{'active': list.sellToggle}"
                                           class="toggle__button">
                                        <span v-if="list.sellYn === 'Y'" class="toggle__label">판매중</span>
                                        <span v-else class="toggle__label">미판매</span>

                                        <input type="checkbox" :id="'newSignUpYnBtn'+idx" v-model="list.sellToggle"
                                               @change="sellToggleBtn(list)">
                                        <span class="toggle__switch"></span>
                                    </label>
                                </td>
                                <td><input style="width: 100%" class="inMoney" type="text" v-model="list.pnOfclSubsd"
                                           placeholder="공시지원금" :disabled="!list.sellToggle">
                                </td>
                                <td>
                                    <input style="width: 100%" class="inMoney" type="text" v-model="list.pnExtSubsdDv"
                                           placeholder="공시 추가지원금" :disabled="!list.sellToggle">
                                </td>
                                <td>
                                    {{Number(selectDevice.pnMsrp - list.pnOfclSubsd -
                                    list.pnExtSubsdDv).toLocaleString()}}
                                </td>
                                <td>
                                    <input style="width: 100%" class="wPer inNumber" type="text"
                                           placeholder="선약 추가지원금" v-model="list.pnExtSubsdRt"
                                           :disabled="!list.sellToggle">
                                </td>
                                <td>
                                    {{Number(selectDevice.pnMsrp - list.pnExtSubsdRt).toLocaleString()}}
                                </td>
                                <td>
                                    <input type="radio" :id="'idxY'+idx" value="Y" v-model="list.pnExtServYn"
                                           :disabled="!list.sellToggle">
                                    <label :for="'idxY'+idx">유</label>
                                    <input type="radio" :id="'idxN'+idx" value="N" v-model="list.pnExtServYn"
                                           :disabled="!list.sellToggle"
                                           @change="list.pnEtc = ''">
                                    <label :for="'idxN'+idx">무</label>
                                </td>
                                <td>
                                    <input style="width: 100%;" type="text" v-model="list.pnEtc"
                                           :disabled="list.pnExtServYn === 'N' || !list.sellToggle">
                                </td>
                            </tr>
                            </tbody>
                            <tbody v-else>
                            <tr>
                                <td>-</td>
                                <td>-</td>
                                <td>-</td>
                                <td>-</td>
                                <td>-</td>
                                <td>-</td>
                                <td>-</td>
                                <td>-</td>
                                <td>-</td>
                                <td>-</td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                    <!-- //content -->
                </div>
                <!-- //content group4 -->

            </div>
        </div>
    </div>
    <!-- //contents -->

</div>

<div layout:fragment="script">
    <script>
        var app = new Vue({
            el: "#app",
            data: {
                deviceCarr: "",
                carr: "",
                sellYn: [
                    {code: "all", value: "전체"},
                    {code: "y", value: "판매중"},
                    {code: "p", value: "판매중지"},
                    {code: "n", value: "미판매"}
                ],
                selectedSellOpt: "all",
                pnMkr: [
                    {code: "all", value: "전체"},
                    {code: "SAM", value: "삼성전자"},
                    {code: "APP", value: "애플"},
                    {code: "LGE", value: "LG전자"},
                    // {code: "XIA", value: "샤오미"},
                    {code: "ETC", value: "기타"}
                ],
                selectedMkr: "all",
                searchKey: "",
                networkType: [
                    {code: "all", value: "전체"},
                    {code: "5g", value: "5G"},
                    {code: "4g", value: "LTE"},
                    {code: "3g", value: "3G"}
                ],
                selectedNetType: "all",
                allchecked: false,
                checkedList: [],
                dpList: [],
                selectDevice: {},
                moveCarrList: [],
                chgDeviceList: [],
                newSignUpList: [],
            },
            mounted: function () {
                var currentPath = window.location.pathname
                this.carr = currentPath.substring(currentPath.lastIndexOf('/') + 1)
                switch (this.carr) {
                    case 'skt':
                        this.deviceCarr = 'S'
                        break
                    case 'kt':
                        this.deviceCarr = 'K'
                        break
                    case 'lgu':
                        this.deviceCarr = 'L'
                        break
                }
                this.searchList()
            },
            methods: {
                searchList: function() {
                    var param = {
                        mntCarr: this.carr,
                        deviceCarr: this.deviceCarr,
                        selectedNetType: this.selectedNetType,
                        pnMkr: this.selectedMkr,
                        searchKey: this.searchKey
                    }
                    cf_call("/carr/getSellDeviceList", param, this.searchListCB)
                },
                searchListCB: function(data) {
                    this.dpList = []
                    switch (this.selectedSellOpt) {
                        case 'y' :
                            for (idx in data.sellDeviceList) {
                                if (data.sellDeviceList[idx].sellStatus === 'Y') {
                                    this.dpList.push(data.sellDeviceList[idx])
                                }
                            }
                            break
                        case 'p' :
                            for (idx in data.sellDeviceList) {
                                if (data.sellDeviceList[idx].sellStatus === 'P') {
                                    this.dpList.push(data.sellDeviceList[idx])
                                }
                            }
                            break
                        case "n" :
                            for (idx in data.sellDeviceList) {
                                if (data.sellDeviceList[idx].sellStatus === 'N') {
                                    this.dpList.push(data.sellDeviceList[idx])
                                }
                            }
                            break
                        default:
                            this.dpList = data.sellDeviceList
                            break
                    }
                    for (sell in this.dpList) {
                        this.dpList[sell].idx = sell
                        this.dpList[sell].mntCarr = this.carr.toUpperCase()

                        switch (this.dpList[sell].pnMkr) {
                            case 'SAM':
                                this.dpList[sell].pnMkr = '삼성전자'
                                break
                            case 'LGE':
                                this.dpList[sell].pnMkr = 'LG전자'
                                break
                            case 'APP':
                                this.dpList[sell].pnMkr = '애플'
                                break
                            case 'XIA':
                                this.dpList[sell].pnMkr = '샤오미'
                                break
                            case 'ETC':
                                this.dpList[sell].pnMkr = '기타'
                                break
                        }
                    }
                },
                getTrClass: function(idx) {
                    if (idx === this.selectDevice.idx) return true
                    else return false
                },
                checkAll: function() {
                    this.checkedList = []

                    if (this.allchecked) {
                        for (list in this.dpList) {
                            this.checkedList.push(this.dpList[list])
                        }
                    }
                },
                chkboxClick: function() {
                    this.allchecked = false
                    if (this.checkedList.length === this.dpList.length) {
                        this.allchecked = true
                    }
                },
                rowClick: function(data, idx) {
                    if (this.selectDevice.idx != idx){
                        this.selectDevice = {}
                        this.selectDevice = data
                        this.selectDevice.idx = idx

                        var param = {
                            pnCarr: this.carr.toUpperCase(),
                            pnNetType: this.selectDevice.pnNetType,
                            pnStor: this.selectDevice.pnStor,
                            pnMdlNo: this.selectDevice.pnMdlNo
                        }
                        cf_call("/carr/getUseMntByDevice", param, this.rowClickCB)
                    } else {
                        this.selectDevice = {}
                        this.currPolicy = {}
                        this.moveCarrList = []
                        this.chgDeviceList = []
                        this.newSignUpList = []
                    }

                },
                rowClickCB: function(data) {
                    this.moveCarrList = []
                    this.chgDeviceList = []
                    this.newSignUpList = []

                    this.moveCarrList = data.moveCarrList
                    for (idx in this.moveCarrList) {
                        if (this.moveCarrList[idx].sellYn === 'Y') {
                            this.moveCarrList[idx].sellToggle = true
                        } else {
                            this.moveCarrList[idx].sellToggle = false
                        }
                        this.moveCarrList[idx].sellYnOrg = this.moveCarrList[idx].sellYn
                        this.moveCarrList[idx].pnOfclSubsdOrg = this.moveCarrList[idx].pnOfclSubsd
                        this.moveCarrList[idx].pnExtSubsdDvOrg = this.moveCarrList[idx].pnExtSubsdDv
                        this.moveCarrList[idx].pnExtSubsdRtOrg = this.moveCarrList[idx].pnExtSubsdRt
                        this.moveCarrList[idx].pnEtcOrg = this.moveCarrList[idx].pnEtc
                        this.moveCarrList[idx].pnExtServYnOrg = this.moveCarrList[idx].pnExtServYn
                    }
                    this.chgDeviceList = data.chgDeviceList
                    for (idx in this.chgDeviceList) {
                        if (this.chgDeviceList[idx].sellYn === 'Y') {
                            this.chgDeviceList[idx].sellToggle = true
                        } else {
                            this.chgDeviceList[idx].sellToggle = false
                        }
                        this.chgDeviceList[idx].sellYnOrg = this.chgDeviceList[idx].sellYn
                        this.chgDeviceList[idx].pnOfclSubsdOrg = this.chgDeviceList[idx].pnOfclSubsd
                        this.chgDeviceList[idx].pnExtSubsdDvOrg = this.chgDeviceList[idx].pnExtSubsdDv
                        this.chgDeviceList[idx].pnExtSubsdRtOrg = this.chgDeviceList[idx].pnExtSubsdRt
                        this.chgDeviceList[idx].pnEtcOrg = this.chgDeviceList[idx].pnEtc
                        this.chgDeviceList[idx].pnExtServYnOrg = this.chgDeviceList[idx].pnExtServYn
                    }
                    this.newSignUpList = data.newSignUpList
                    for (idx in this.newSignUpList) {
                        if (this.newSignUpList[idx].sellYn === 'Y') {
                            this.newSignUpList[idx].sellToggle = true
                        } else {
                            this.newSignUpList[idx].sellToggle = false
                        }
                        this.newSignUpList[idx].sellYnOrg = this.newSignUpList[idx].sellYn
                        this.newSignUpList[idx].pnOfclSubsdOrg = this.newSignUpList[idx].pnOfclSubsd
                        this.newSignUpList[idx].pnExtSubsdDvOrg = this.newSignUpList[idx].pnExtSubsdDv
                        this.newSignUpList[idx].pnExtSubsdRtOrg = this.newSignUpList[idx].pnExtSubsdRt
                        this.newSignUpList[idx].pnEtcOrg = this.newSignUpList[idx].pnEtc
                        this.newSignUpList[idx].pnExtServYnOrg = this.newSignUpList[idx].pnExtServYn
                    }
                },
                stopSale: function() {
                    var saleYn = false
                    if (!this.checkedList.length) alert('판매중지할 모델을 선택해주세요.')
                    else {
                        if (confirm('선택하신 모델의 판매를 중지하시겠습니까?')) {
                            for (idx in this.checkedList) {
                                // sellYn의 값이 없으면(미판매) true
                                if (!this.checkedList[idx].sellStatus) saleYn = true
                            }
                            // 판매상태 - 미판매중인
                            if (saleYn) alert("선택하신 모델의 판매상태를 확인해주세요.")
                            else {
                                cf_call("/carr/stopSaleDev", this.checkedList, this.stopSaleCB)
                            }
                        }
                    }
                },
                stopSaleCB: function(data) {
                    alert('선택하신 모델의 판매가 중지되었습니다.')
                    if (data.succ === "Y") {
                        this.selectDevice = {}
                        this.checkedList = []
                        this.moveCarrList = []
                        this.chgDeviceList = []
                        this.newSignUpList = []
                        this.searchList()
                    }
                },
                sellToggleBtn: function(data) {
                    if (data.sellToggle === true) {
                        data.sellYn = 'Y'
                    } else {
                        data.sellYn = 'N'
                    }
                },
                savePolicy: function(type) {
                    var tempArr = []
                    var keyword = ''
                    switch (type) {
                        case 'moveCarr' :
                            tempArr = this.moveCarrList
                            keyword = '번호이동'
                            break
                        case 'chgDevice' :
                            tempArr = this.chgDeviceList
                            keyword = '기기변경'
                            break
                        case 'newSignUp' :
                            tempArr = this.newSignUpList
                            keyword = '신규가입'
                            break
                    }
                    if (!tempArr.length) alert('정책을 저장할 모델을 선택해주세요')
                    else {
                        if (confirm(keyword + '정책을 저장하시겠습니까?')) {
                            for (idx in tempArr) {
                                tempArr[idx].pnMdlNo = this.selectDevice.pnMdlNo
                                tempArr[idx].pnStor = this.selectDevice.pnStor
                                tempArr[idx].mntCarr = this.carr.toUpperCase()

                                if (this.changeChk(tempArr[idx])) {
                                    tempArr[idx].saveYn = 'N' // return true. 값 변동 없음
                                } else tempArr[idx].saveYn = 'Y' // return false. 값 변동 있음
                            }
                            cf_call("/carr/saveSalePolicy/" + type, tempArr, this.savePolicyCB);
                        }
                    }
                },
                savePolicyCB: function(data) {
                    if (data.succ === "Y") {
                        alert('저장되었습니다.')

                        this.selectDevice = {}
                        this.checkedList = []
                        this.moveCarrList = []
                        this.chgDeviceList = []
                        this.newSignUpList = []
                        this.searchList()
                    }
                },
                changeChk: function(data) {
                    var sellYn = data.sellYnOrg === data.sellYn
                    var pnOfclSubsd = data.pnOfclSubsdOrg === data.pnOfclSubsd
                    var pnExtSubsdDv = data.pnExtSubsdDvOrg === data.pnExtSubsdDv
                    var pnExtSubsdRt = data.pnExtSubsdRtOrg === data.pnExtSubsdRt
                    var pnEtc = data.pnEtcOrg === data.pnEtc
                    // var pnExtServYn = data.pnExtServYnOrg === data.pnExtServYn
                    return (sellYn && pnOfclSubsd && pnExtSubsdDv && pnExtSubsdRt && pnEtc)
                }
            }
        })
    </script>
</div>


</html>